<odoo>
    <data>
        <record id="material_requisition_slip_form_view" model="ir.ui.view">
            <field name="name">material.requisition.slip.form</field>
            <field name="model">material.requisition.slip</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Material Requisition Slip">
                        <header>
                            <button name="action_waiting_for_approval" string="Send For Approval" type="object" states="draft" class="oe_highlight" />
                            <button name="action_approved" string="Approve" type="object" states="waiting_for_approval" class="oe_highlight" groups="AGAF_Project.group_estimation_manager_mrs"/>
                            <button name="action_rejected" string="Reject" type="object" states="waiting_for_approval" class="oe_highlight" />
                            <field name="state" widget="statusbar" statusbar_visible="draft,waiting_for_approval,approved,rejected" />
                        </header>
                    <sheet>
                        <h1>
                            <field name="name"/>
                        </h1>
                        <group>
                            <group>
                                <field name="department_id" readonly="1"/>
                                <field name="project_id" attrs="{'readonly': [('state', 'in', ['rejected','approved'])]}"/>
                                <field name="task_id" readonly="1" force_save="1"/>
                                <field name="phase_id" force_save="1" readonly="1"/>
                                <field name="project_manager_id"/>
                            </group>
                            <group>
                                <field name="request_date" attrs="{'readonly': [('state', 'in', ['rejected','approved'])]}"/>
                                <field name="requestor_name" attrs="{'readonly': [('state', 'in', ['rejected','approved'])]}" required="1"/>
                                <field name="company_id" attrs="{'readonly': [('state', 'in', ['rejected','approved'])]}"/>
                                <field name="requested_by" readonly="1" invisible="1"/>
                                <field name="requested_comments"/>
                                <field name="approved_by" readonly="1" invisible="1"/>
                                <field name="approved_date" readonly="1" invisible="1"/>
<!--                                <button name="compute_requisitions_lines" type="object" class="oe_highlight" string="Generate Lines" style="width:180px;"/>-->
                            </group>
                        </group>
                        <notebook>
                            <page string="Required Materials">
                                <field name="slip_line_ids" widget="one2many" attrs="{'readonly': [('state', '=','approved')]}">
                                    <tree string="Materials"  editable="bottom" limit="25">
                                        <field name="sr_no" />
                                        <field name="product_id" />
                                        <field name="product_qty" />
                                        <field name="uom_id" />
                                        <field name="rate" invisible="1"/>
                                    </tree>
                                </field>
                            </page>

                            <page string="Audit Trail">
                                <field name="trail_ids" >
                                    <tree create="false" delete="false" editable="bottom">
                                        <field name="date" readonly="1"/>
                                        <field name="author_id" readonly="1"/>
                                        <field name="to_stage" readonly="1"/>
                                        <field name="remark" readonly="1"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Reject Reason" attrs="{'invisible': [('state', '!=', 'rejected')]}">
                                <field name="reject_reason" readonly="1" force_save="1"/>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="material_requisition_slip_tree_view" model="ir.ui.view">
            <field name="name">material.requisition.slip.tree</field>
            <field name="model">material.requisition.slip</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree multi_edit="0" edit="0">
                    <field name="name"/>
                    <field name="department_id"/>
                    <field name="project_id"/>
                    <field name="request_date"/>
                    <field name="requestor_name"/>
                    <field name="company_id"/>
                </tree>
            </field>
        </record>

         <record model="ir.actions.act_window" id="action_requisition_slip">
              <field name="name">Material Requisition Slip</field>
              <field name="res_model">material.requisition.slip</field>
              <field name="view_mode">tree,form</field>
         </record>

        <menuitem
            id="material_requisition_slip"
            name="Material Requisition Slip"
            parent="stock.menu_stock_warehouse_mgmt"
            action="action_requisition_slip"
            sequence="200"/>
    </data>
</odoo>